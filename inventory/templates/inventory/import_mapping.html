{% extends 'inventory/base.html' %}
{% load static %}
{% block content %}
<div class="container py-5">
  <h2>Map Excel columns to your Item fields</h2>
  <p>File: <strong>{{ filename }}</strong></p>

  <form method="post" action="{% url 'import_items_map' %}">
    {% csrf_token %}
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Excel Column</th>
          <th>Preview (first {{ preview_rows|length }} rows)</th>
          <th>Map to field</th>
        </tr>
      </thead>
      <tbody>
        {% for col in cols %}
        <tr>
          <td style="min-width:200px;"><strong>{{ col }}</strong></td>
          <td>
            <ul style="padding-left: 16px;">
              {% for row in preview_rows %}
              <li>{{ row|slice:forloop.counter0|default:"" }}</li>
              {% endfor %}
            </ul>
          </td>
          <td>
            <select name="map_{{ forloop.counter0 }}" class="form-select">
              <option value="">-- skip --</option>
              {% for field_name, label in importable_fields.items %}
                <option value="{{ field_name }}">{{ label }}</option>
              {% endfor %}
            </select>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="mt-3">
      <button class="btn btn-success" type="submit">Import mapped rows</button>
      <a href="{% url 'import_items_upload' %}" class="btn btn-secondary">Back</a>
    </div>
  </form>
</div>
{% endblock %}
